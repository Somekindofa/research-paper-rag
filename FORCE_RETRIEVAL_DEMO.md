# Force Retrieval Toggle - Visual Demonstration

## Interface Screenshots (Text Representation)

### Screenshot 1: Force Retrieval OFF (Simple LLM Mode)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“š Research RAG Assistant                                           â”‚
â”‚                                                                       â”‚
â”‚ AI-powered research paper query and analysis system                  â”‚
â”‚ Force Retrieval OFF: Simple LLM chat (fast, no document search)     â”‚
â”‚ Force Retrieval ON: Full RAG with document retrieval and citations  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ â˜ ğŸ” Force Retrieval      â”‚  âš™ï¸ Settings                       â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ Enable to search docs     â”‚  ğŸ¤– Model: llama-70b-chat â–¼       â”‚ â”‚
â”‚ â”‚ Disable for faster chat   â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚  ğŸ“Š Retrieval Settings             â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  Documents: 5                      â”‚ â”‚
â”‚ â”‚                           â”‚  Threshold: 75%                    â”‚ â”‚
â”‚ â”‚ User:                     â”‚                                     â”‚ â”‚
â”‚ â”‚ What is SLAM?             â”‚  ğŸ“Š System Status                  â”‚ â”‚
â”‚ â”‚                           â”‚  âœ… LM Studio Connected            â”‚ â”‚
â”‚ â”‚ Bot:                      â”‚  Models: 3                         â”‚ â”‚
â”‚ â”‚ SLAM stands for           â”‚                                     â”‚ â”‚
â”‚ â”‚ Simultaneous Localization â”‚  ğŸ“Š Library Status                 â”‚ â”‚
â”‚ â”‚ and Mapping, a technique  â”‚  PDFs: 127                         â”‚ â”‚
â”‚ â”‚ used in robotics and      â”‚  Indexed: 100                      â”‚ â”‚
â”‚ â”‚ autonomous vehicles to    â”‚  Chunks: 12,458                    â”‚ â”‚
â”‚ â”‚ build a map of an         â”‚                                     â”‚ â”‚
â”‚ â”‚ unknown environment while â”‚  [ğŸ”„ Refresh]                     â”‚ â”‚
â”‚ â”‚ simultaneously keeping    â”‚                                     â”‚ â”‚
â”‚ â”‚ track of their location   â”‚  ğŸ“¥ Indexing                       â”‚ â”‚
â”‚ â”‚ within it.                â”‚  [ğŸ“¥ Start Indexing]              â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ [Direct LLM response,     â”‚                                     â”‚ â”‚
â”‚ â”‚  no citations - FAST]     â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚ Your message: ______________________________________________ [Send]   â”‚
â”‚                                                                       â”‚
â”‚ [Clear Chat]                                                          â”‚
â”‚                                                                       â”‚
â”‚ Tip: Use Force Retrieval OFF for general conversation                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Response Time**: ~3 seconds  
**Features**: Direct LLM, no document search, conversational


### Screenshot 2: Force Retrieval ON (Full RAG Mode)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“š Research RAG Assistant                                           â”‚
â”‚                                                                       â”‚
â”‚ AI-powered research paper query and analysis system                  â”‚
â”‚ Force Retrieval OFF: Simple LLM chat (fast, no document search)     â”‚
â”‚ Force Retrieval ON: Full RAG with document retrieval and citations  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ â˜‘ ğŸ” Force Retrieval      â”‚  âš™ï¸ Settings                       â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ Enable to search docs     â”‚  ğŸ¤– Model: llama-70b-chat â–¼       â”‚ â”‚
â”‚ â”‚ Disable for faster chat   â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚  ğŸ“Š Retrieval Settings             â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  Documents: 5                      â”‚ â”‚
â”‚ â”‚                           â”‚  Threshold: 75%                    â”‚ â”‚
â”‚ â”‚ User:                     â”‚                                     â”‚ â”‚
â”‚ â”‚ What are the latest       â”‚  ğŸ“Š System Status                  â”‚ â”‚
â”‚ â”‚ approaches to SLAM in     â”‚  âœ… LM Studio Connected            â”‚ â”‚
â”‚ â”‚ constrained hardware?     â”‚  Models: 3                         â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ Bot:                      â”‚  ğŸ“Š Library Status                 â”‚ â”‚
â”‚ â”‚ Based on your research    â”‚  PDFs: 127                         â”‚ â”‚
â”‚ â”‚ papers:                   â”‚  Indexed: 100                      â”‚ â”‚
â”‚ â”‚                           â”‚  Chunks: 12,458                    â”‚ â”‚
â”‚ â”‚ Recent approaches to SLAM â”‚                                     â”‚ â”‚
â”‚ â”‚ in resource-constrained   â”‚  [ğŸ”„ Refresh]                     â”‚ â”‚
â”‚ â”‚ hardware focus on three   â”‚                                     â”‚ â”‚
â”‚ â”‚ main strategies:          â”‚  ğŸ“¥ Indexing                       â”‚ â”‚
â”‚ â”‚                           â”‚  [ğŸ“¥ Start Indexing]              â”‚ â”‚
â”‚ â”‚ 1. Feature-based methods  â”‚                                     â”‚ â”‚
â”‚ â”‚ [Smith et al., 2024]      â”‚                                     â”‚ â”‚
â”‚ â”‚ propose a lightweight     â”‚                                     â”‚ â”‚
â”‚ â”‚ ORB-SLAM variant...       â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ 2. Direct methods         â”‚                                     â”‚ â”‚
â”‚ â”‚ [Johnson & Lee, 2023]...  â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ 3. Learned features       â”‚                                     â”‚ â”‚
â”‚ â”‚ [Zhang et al., 2024]...   â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ ğŸ“š Sources (3 documents): â”‚                                     â”‚ â”‚
â”‚ â”‚ [1] Lightweight ORB-SLAM  â”‚                                     â”‚ â”‚
â”‚ â”‚     (Smith, 2024) - 0.89  â”‚                                     â”‚ â”‚
â”‚ â”‚ [2] Direct Visual SLAM    â”‚                                     â”‚ â”‚
â”‚ â”‚     (Johnson, 2023) - 0.85â”‚                                     â”‚ â”‚
â”‚ â”‚ [3] Neural SLAM           â”‚                                     â”‚ â”‚
â”‚ â”‚     (Zhang, 2024) - 0.82  â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â”‚ [RAG with citations -     â”‚                                     â”‚ â”‚
â”‚ â”‚  documents retrieved]     â”‚                                     â”‚ â”‚
â”‚ â”‚                           â”‚                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚ Your message: ______________________________________________ [Send]   â”‚
â”‚                                                                       â”‚
â”‚ [Clear Chat]                                                          â”‚
â”‚                                                                       â”‚
â”‚ Tip: Use Force Retrieval ON for research questions with citations    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Response Time**: ~8 seconds  
**Features**: Full RAG pipeline, document retrieval, citations, metadata


## Key Differences

| Feature | Force Retrieval OFF | Force Retrieval ON |
|---------|-------------------|-------------------|
| **Toggle State** | â˜ Unchecked | â˜‘ Checked |
| **Pipeline** | Direct LLM | Full RAG (HyDEâ†’Retrieveâ†’Rerankâ†’Generate) |
| **Response Time** | ~2-5 seconds | ~5-15 seconds |
| **Document Search** | âŒ No | âœ… Yes |
| **Citations** | âŒ No | âœ… Yes |
| **Source Documents** | âŒ No | âœ… Yes (with scores) |
| **Best For** | General chat, definitions | Research questions, lit review |
| **Accuracy** | General knowledge | Grounded in your papers |

## Usage Scenarios

### Scenario 1: Quick Definition (Use Simple LLM)
```
Toggle: OFF
Question: "What does SLAM stand for?"
Result: Fast, conversational answer
```

### Scenario 2: Literature Review (Use RAG)
```
Toggle: ON
Question: "Compare the SLAM approaches in papers from 2023-2024"
Result: Detailed answer with citations from your papers
```

### Scenario 3: Mixed Conversation
```
1. Toggle: OFF â†’ "Hello, how are you?" (fast chat)
2. Toggle: ON â†’ "Find papers about drone calibration" (search)
3. Toggle: OFF â†’ "Thank you!" (fast chat)
4. Toggle: ON â†’ "Summarize the methodology" (detailed with citations)
```

## Implementation Details

The toggle controls which function is called:

```python
def handle_message(message, history, force_retrieval, ...):
    if force_retrieval:
        return rag_chat(...)      # Full pipeline
    else:
        return simple_llm_chat(...)  # Direct LLM
```

**Simple LLM Path:**
```
User Input â†’ LM Studio Client â†’ Response
```

**RAG Path:**
```
User Input â†’ Pipeline.invoke() â†’ 
  HyDE â†’ Embed â†’ MMR â†’ Rerank â†’ Generate â†’ 
  Response + Sources
```

## Benefits

1. **User Control**: Choose when to use expensive RAG
2. **Performance**: Faster for simple queries
3. **Flexibility**: Mix modes in same conversation
4. **Efficiency**: Don't search when not needed
5. **Clarity**: Clear indication of which mode is active
